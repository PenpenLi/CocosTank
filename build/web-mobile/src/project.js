require=function i(r,l,c){function s(e,t){if(!l[e]){if(!r[e]){var a="function"==typeof require&&require;if(!t&&a)return a(e,!0);if(p)return p(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var n=l[e]={exports:{}};r[e][0].call(n.exports,function(t){return s(r[e][1][t]||t)},n,n.exports,i,r,l,c)}return l[e].exports}for(var p="function"==typeof require&&require,t=0;t<c.length;t++)s(c[t]);return s}({BattleCatrl:[function(t,e,a){"use strict";cc._RF.push(e,"13937DLhkBG67xqI6V6mxta","BattleCatrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("../Unit/LinkedMap"),n=t("../WebSocketManage"),i=t("./HomePageCtrl"),r=cc._decorator,l=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wall_column_1=null,t.wall_row_1=null,t.wall_column_2=null,t.wall_row_2=null,t.wall_column_3=null,t.wall_row_3=null,t.BattleRegion=null,t.TopCell=null,t.BottomCell=null,t.LeftCell=null,t.RightCell=null,t.player1=null,t.player2=null,t.fllower_1=null,t.fllower_2=null,t.fllower_3=null,t.horn_1=null,t.horn_2=null,t.horn_3=null,t.webScoket=null,t.battleData=[{row:3,column:7,scale:1},{row:4,column:9,scale:.775},{row:5,column:11,scale:.645}],t.activeBattleData=null,t.cells=0,t.externalResources=[],t.activeExternalData=null,t.linkedMap={},t.player=[],t.Exterrandom=0,t.playerName="tank_1",t.MainPlayerHeadImg=null,t.MainPlayerName=null,t.MainPlayerScore=null,t.VicePlayerHeadImg=null,t.VicePlayerName=null,t.VicePlayerScore=null,t}return __extends(t,e),t.prototype.start=function(){this.webScoket=cc.find("WebScoket").getComponent(n.default),this.initBattleData()},t.prototype.initScore=function(t){var a=this,e=cc.find("Canvas/HomePagePanel").getComponent(i.default),o=e.UserData,n=e.enemyUserData;0===t?(cc.loader.load({url:o.headimgurl,type:"png"},function(t,e){a.MainPlayerHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),a.MainPlayerName.getComponent(cc.Label).string=o.nickname,cc.loader.load({url:n.headimgurl,type:"png"},function(t,e){a.VicePlayerHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),a.VicePlayerName.getComponent(cc.Label).string=n.nickname):(cc.loader.load({url:o.headimgurl,type:"png"},function(t,e){a.VicePlayerHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),a.VicePlayerName.getComponent(cc.Label).string=o.nickname,cc.loader.load({url:n.headimgurl,type:"png"},function(t,e){a.MainPlayerHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),a.MainPlayerName.getComponent(cc.Label).string=n.nickname)},t.prototype.restart=function(t){if(0===t){var e=this.MainPlayerScore.getComponent(cc.Label).string;this.MainPlayerScore.getComponent(cc.Label).string=parseInt(e)+1+""}else{e=this.VicePlayerScore.getComponent(cc.Label).string;this.VicePlayerScore.getComponent(cc.Label).string=parseInt(e)+1+""}this.TopCell.removeAllChildren(),this.LeftCell.removeAllChildren(),this.RightCell.removeAllChildren(),this.BottomCell.removeAllChildren(),this.BattleRegion.removeAllChildren(),"tank_2"!==this.playerName&&(this.initBattleData(),this.sendCallBackFor0())},t.prototype.initBattleData=function(){this.externalResources=[{cellColumn:this.wall_column_1,cellRow:this.wall_row_1,flower:this.fllower_1,horn:this.horn_1,bg:"floor_1"},{cellColumn:this.wall_column_2,cellRow:this.wall_row_2,flower:this.fllower_2,horn:this.horn_2,bg:"floor_2"},{cellColumn:this.wall_column_3,cellRow:this.wall_row_3,flower:this.fllower_3,horn:this.horn_3,bg:"floor_3"}];var t=Math.random()*this.battleData.length>>0;this.activeBattleData=this.battleData[t],this.Exterrandom=Math.random()*this.externalResources.length>>0,this.activeExternalData=this.externalResources[this.Exterrandom],this.cells=this.activeBattleData.column*this.activeBattleData.row,this.initPlayerPoint()},t.prototype.sendCallBackFor0=function(){var t=this;t.linkedMap=new o.default(t.activeBattleData.column,t.activeBattleData.row,t.player[0].point,t.player[1].point).generate(),t.externalCell();for(var e=0;e<t.cells;e++)t.generateRegion(e);t.webScoket.sendMessage({msg:21,data:{battleData:[{column:t.activeBattleData.column,row:t.activeBattleData.row,scale:t.activeBattleData.scale}],player:t.player,externaData:this.Exterrandom,linkedMap:t.linkedMap}})},t.prototype.sendCallBackFor1=function(t){var e=this;e.playerName="tank_2",e.linkedMap=t.data.linkedMap,e.player=t.data.player,e.activeExternalData=e.externalResources[t.data.externaData],e.activeBattleData=t.data.battleData[0];var a=e.activeBattleData.column*e.activeBattleData.row;e.externalCell();for(var o=0;o<a;o++)e.generateRegion(o)},t.prototype.initPlayerPoint=function(){this.player=[],this.player.push({point:Math.random()*this.cells>>0,rotation:180*Math.random()>>0}),this.player.push({point:Math.random()*this.cells>>0,rotation:180*Math.random()>>0}),this.player[0]===this.player[1]&&this.initPlayerPoint()},t.prototype.setCellData=function(t,e){var a;return 0===t?(a=cc.instantiate(this.activeExternalData.cellColumn)).scale=e:(a=cc.instantiate(this.activeExternalData.cellRow)).scale=e,a},t.prototype.setHornData=function(t,e){var a=new cc.Node;return a.addComponent(cc.Sprite).spriteFrame=this.activeExternalData.horn,a.scale=t,a.rotation=e,a},t.prototype.setFlowerData=function(t,e){var a=new cc.Node;return a.addComponent(cc.Sprite).spriteFrame=this.activeExternalData.flower,a.scale=t,a.rotation=e,a},t.prototype.externalCell=function(){var a=this;cc.loader.loadRes(a.activeExternalData.bg,cc.SpriteFrame,function(t,e){a.BattleRegion.getComponent(cc.Sprite).spriteFrame=e});for(var t=this.TopCell.width/this.activeBattleData.column,e=t/194/.8814,o=0;o<this.activeBattleData.column;o++){(l=this.setCellData(0,e)).setPosition(t*o-this.BottomCell.width/2+t/2,0),this.BottomCell.addChild(l);var n=this.setHornData(e,180);n.setPosition(-this.BottomCell.width/2-n.width*e/6,-n.height*e/3.5),this.BottomCell.addChild(n),(n=this.setHornData(e,90)).setPosition(this.BottomCell.width/2+n.width*e/1.5,-n.height*e/3.5),this.BottomCell.addChild(n),(r=this.setFlowerData(e,180)).setPosition(t*o-this.BottomCell.width/2+t/2+10*e,-r.height*e/2),this.BottomCell.addChild(r),(n=this.setHornData(e,270)).setPosition(-this.TopCell.width/2-n.width*e/5,n.height*e/2),this.TopCell.addChild(n),(n=this.setHornData(e,0)).setPosition(this.TopCell.width/2+n.width*e/1.7,n.height*e/2),this.TopCell.addChild(n),(l=this.setCellData(0,e)).setPosition(t*o-this.TopCell.width/2+t/2,0),this.TopCell.addChild(l),(r=this.setFlowerData(e,0)).setPosition(t*o-this.TopCell.width/2+t/2+10*e,r.height*e/2+l.height*e/2),this.TopCell.addChild(r)}var i=this.LeftCell.height/this.activeBattleData.row;e=i/194/.88;for(o=0;o<this.activeBattleData.row;o++){var r,l;(r=this.setFlowerData(e,270)).setPosition(-r.height*e/2+.5,i*o-this.LeftCell.height/2+i/2+12*e),this.LeftCell.addChild(r),(l=this.setCellData(1,e)).setPosition(0,i*o-this.LeftCell.height/2+i/2),this.LeftCell.addChild(l),(l=this.setCellData(1,e)).setPosition(0,i*o-this.RightCell.height/2+i/2),this.RightCell.addChild(l),(r=this.setFlowerData(e,90)).setPosition(r.height*e/2+l.width*e/2,i*o-this.RightCell.height/2+i/2+11*e),this.RightCell.addChild(r)}},t.prototype.generateRegion=function(t){var e=t/this.activeBattleData.column>>0,a=t%this.activeBattleData.column,o=new cc.Node("layoutNode"),n=Math.floor(this.BattleRegion.width/this.activeBattleData.column*100)/100,i=this.BattleRegion.height/this.activeBattleData.row;if(o.addComponent(cc.Layout),o.setContentSize(n,i),this.BattleRegion.addChild(o),a!==this.activeBattleData.column-1&&(!this.linkedMap[t]||this.linkedMap[t].indexOf(t+1)<0)){var r=i/194/.8814,l=cc.instantiate(this.activeExternalData.cellRow);o.addChild(l),l.scale=r,l.setPosition(this.BattleRegion.width/this.activeBattleData.column*(a+1),-l.height*r/2-e*l.height*r+l.height*r*.1185*e+10*r)}if(e!==this.activeBattleData.row-1&&(!this.linkedMap[t]||this.linkedMap[t].indexOf(t+this.activeBattleData.column)<0)){r=n/194/.8814;var c=cc.instantiate(this.activeExternalData.cellColumn);o.addChild(c),c.scale=r,c.setPosition(this.BattleRegion.width/this.activeBattleData.column*(a+1)-c.width*r/2+7*r,-this.BattleRegion.height/this.activeBattleData.row*(e+1))}if(t===this.player[0].point){var s=cc.instantiate(this.player1);s.scale=this.activeBattleData.scale,s.rotation=this.player[0].rotation,s.setPosition(this.BattleRegion.width/this.activeBattleData.column*a+this.BattleRegion.width/this.activeBattleData.column/2,-this.BattleRegion.height/this.activeBattleData.row*e-this.BattleRegion.height/this.activeBattleData.row/2),o.addChild(s)}if(t===this.player[1].point){var p=cc.instantiate(this.player2);p.scale=this.activeBattleData.scale,p.rotation=this.player[1].rotation,p.setPosition(this.BattleRegion.width/this.activeBattleData.column*a+this.BattleRegion.width/this.activeBattleData.column/2,-this.BattleRegion.height/this.activeBattleData.row*e-this.BattleRegion.height/this.activeBattleData.row/2),o.addChild(p)}},__decorate([c(cc.Prefab)],t.prototype,"wall_column_1",void 0),__decorate([c(cc.Prefab)],t.prototype,"wall_row_1",void 0),__decorate([c(cc.Prefab)],t.prototype,"wall_column_2",void 0),__decorate([c(cc.Prefab)],t.prototype,"wall_row_2",void 0),__decorate([c(cc.Prefab)],t.prototype,"wall_column_3",void 0),__decorate([c(cc.Prefab)],t.prototype,"wall_row_3",void 0),__decorate([c(cc.Node)],t.prototype,"BattleRegion",void 0),__decorate([c(cc.Node)],t.prototype,"TopCell",void 0),__decorate([c(cc.Node)],t.prototype,"BottomCell",void 0),__decorate([c(cc.Node)],t.prototype,"LeftCell",void 0),__decorate([c(cc.Node)],t.prototype,"RightCell",void 0),__decorate([c(cc.Prefab)],t.prototype,"player1",void 0),__decorate([c(cc.Prefab)],t.prototype,"player2",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"fllower_1",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"fllower_2",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"fllower_3",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"horn_1",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"horn_2",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"horn_3",void 0),__decorate([c(cc.Node)],t.prototype,"MainPlayerHeadImg",void 0),__decorate([c(cc.Node)],t.prototype,"MainPlayerName",void 0),__decorate([c(cc.Node)],t.prototype,"MainPlayerScore",void 0),__decorate([c(cc.Node)],t.prototype,"VicePlayerHeadImg",void 0),__decorate([c(cc.Node)],t.prototype,"VicePlayerName",void 0),__decorate([c(cc.Node)],t.prototype,"VicePlayerScore",void 0),t=__decorate([l],t)}(cc.Component);a.default=s,cc._RF.pop()},{"../Unit/LinkedMap":"LinkedMap","../WebSocketManage":"WebSocketManage","./HomePageCtrl":"HomePageCtrl"}],BulletCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"2a2bbazLDJL6aDlFXxZ1Za8","BulletCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("../WebSocketManage"),n=cc._decorator,i=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.WebScoket=null,t.speedX=5,t.speedY=5,t}return __extends(t,e),t.prototype.start=function(){var t=this;this.WebScoket=cc.find("WebScoket").getComponent(o.default),setTimeout(function(){t.node&&t.node.destroy()},5e3)},t.prototype.update=function(t){var e=this.node.rotation;this.node.x+=this.speedX*Math.sin(Math.PI*e/180),this.node.y+=this.speedY*Math.cos(Math.PI*e/180)},t.prototype.onCollisionEnter=function(t,e){switch(t.tag){case 0:this.speedY*=-1;break;case 1:this.speedX*=-1;break;case 2:this.speedY*=-1;break;case 3:this.speedX*=-1}},t.prototype.onDestroy=function(){this.node.destroy()},t=__decorate([i],t)}(cc.Component));a.default=r,cc._RF.pop()},{"../WebSocketManage":"WebSocketManage"}],CellCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"1a3ddLI5Y9ET54Wf+qMBtnj","CellCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,i=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){var t=cc.director.getCollisionManager();t.enabled=!0,t.enabledDrawBoundingBox=!0},e=__decorate([n],e)}(cc.Component));a.default=i,cc._RF.pop()},{}],HomePageCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"34123NWVIRNU6xkpmnqGz20","HomePageCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("../WebSocketManage"),n=cc._decorator,i=n.ccclass,r=n.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lobbyPanel=null,t.openSoundSprite=null,t.closeSoundSprite=null,t.bgSound=null,t.IsSound=!0,t.UserData={},t.enemyUserData={},t.WebScoketNode=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.OnClickStartButton=function(){this.WebScoketNode.getComponent(o.default).sendMessage({msg:1})},t.prototype.OnClickSoundButton=function(t){this.IsSound=!this.IsSound;var e=t.target.getComponent(cc.Sprite);this.IsSound?(e.spriteFrame=this.openSoundSprite,this.bgSound.resume()):(e.spriteFrame=this.closeSoundSprite,this.bgSound.pause())},t.prototype.getUserData=function(t){this.UserData=t.data,cc.instantiate(this.lobbyPanel).parent=this.node.parent,this.enabled=!1},__decorate([r(cc.Prefab)],t.prototype,"lobbyPanel",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"openSoundSprite",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"closeSoundSprite",void 0),__decorate([r(cc.AudioSource)],t.prototype,"bgSound",void 0),__decorate([r(cc.Node)],t.prototype,"WebScoketNode",void 0),t=__decorate([i],t)}(cc.Component);a.default=l,cc._RF.pop()},{"../WebSocketManage":"WebSocketManage"}],LinkedMap:[function(t,e,a){"use strict";cc._RF.push(e,"2422a/26gRHUKNZEy4tBNpQ","LinkedMap"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function t(t,e,a,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===a&&(a=0),void 0===o&&(o=0),this.column=0,this.row=0,this.cells=0,this.player_1=0,this.player_2=0,this.linkedMap={},this.unionSets=null,this.column=t,this.row=e,this.cells=t*e,this.player_1=a,this.player_2=o,this.unionSets=new n(this.cells)}return t.prototype.generate=function(){for(;!this.playerLinked();){var t=this.pickRandomCellPairs();this.unionSets.sameSet(t[0],t[1])||(this.unionSets.union(t[0],t[1]),this.addLinkedMap(t[0],t[1]))}return this.linkedMap},t.prototype.playerLinked=function(){return this.unionSets.sameSet(this.player_1,this.player_2)},t.prototype.pickRandomCellPairs=function(){var t=Math.random()*this.cells>>0,e=[],a=t/this.column>>0,o=t%this.column;return 0!==a&&e.push(t-this.column),a!==this.row-1&&e.push(t+this.column),0!==o&&e.push(t-1),o!==this.column-1&&e.push(t+1),[t,e[Math.random()*e.length>>0]]},t.prototype.addLinkedMap=function(t,e){this.linkedMap[t]||(this.linkedMap[t]=[]),this.linkedMap[e]||(this.linkedMap[e]=[]),this.linkedMap[t].indexOf(e)<0&&this.linkedMap[t].push(e),this.linkedMap[e].indexOf(t)<0&&this.linkedMap[e].push(t)},t}();a.default=o;var n=function(){function t(t){this.setArray=null,this.setArray=new Array(t);for(var e=this.setArray.length-1;0<=e;e--)this.setArray[e]=-1}return t.prototype.union=function(t,e){if(-1===this.setArray[t]&&-1===this.setArray[e])this.setArray[t]=e,this.setArray[e]=t;else if(-1===this.setArray[t]&&-1!==this.setArray[e])this.setArray[t]=this.setArray[e];else if(-1!==this.setArray[t]&&-1===this.setArray[e])this.setArray[e]=this.setArray[t];else for(var a=this.setArray[t],o=0;o<this.setArray.length;o++)this.setArray[o]===a&&(this.setArray[o]=this.setArray[e])},t.prototype.sameSet=function(t,e){return-1!==this.setArray[t]&&-1!==this.setArray[e]&&this.setArray[t]===this.setArray[e]},t}();cc._RF.pop()},{}],LobbyPageCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"8be5etHjxBFJ7oy5iXmUq28","LobbyPageCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("./HomePageCtrl"),n=cc._decorator,i=n.ccclass,r=n.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matchingPanel=null,t.headImg=null,t.userName=null,t.HomePage=null,t}return __extends(t,e),t.prototype.onClickBackButton=function(){this.node.destroy()},t.prototype.onClickMatching=function(){cc.instantiate(this.matchingPanel).parent=this.node.parent,this.enabled=!1},t.prototype.start=function(){var a=this;this.HomePage=cc.find("Canvas/HomePagePanel");var t=this.HomePage.getComponent(o.default).UserData;this.userName.getComponent(cc.Label).string=t.nickname,cc.loader.load({url:t.headimgurl,type:"png"},function(t,e){a.headImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)})},__decorate([r(cc.Prefab)],t.prototype,"matchingPanel",void 0),__decorate([r(cc.Node)],t.prototype,"headImg",void 0),__decorate([r(cc.Node)],t.prototype,"userName",void 0),t=__decorate([i],t)}(cc.Component);a.default=l,cc._RF.pop()},{"./HomePageCtrl":"HomePageCtrl"}],LoginPageCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"d2df5VGenVNoJazyDhc4uYt","LoginPageCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("../WebSocketManage"),n=cc._decorator,i=n.ccclass,r=n.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userName=null,t.WebScoketNode=null,t.BattlePage=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.onLogin=function(){var t=this.userName.getComponent(cc.EditBox).string;this.WebScoketNode.getComponent(o.default).sendMessage({name:t}),cc.instantiate(this.BattlePage).parent=this.node.parent,this.enabled=!1},__decorate([r(cc.Node)],t.prototype,"userName",void 0),__decorate([r(cc.Node)],t.prototype,"WebScoketNode",void 0),__decorate([r(cc.Prefab)],t.prototype,"BattlePage",void 0),t=__decorate([i],t)}(cc.Component);a.default=l,cc._RF.pop()},{"../WebSocketManage":"WebSocketManage"}],MatchingCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"1dbafsnqO5BzadTTzTYpDVp","MatchingCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("../WebSocketManage"),n=t("./HomePageCtrl"),i=t("./BattleCatrl"),r=cc._decorator,l=r.ccclass,c=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.WebScoketNode=null,t.headImg=null,t.Success=null,t.MainPlaysName=null,t.MainPlaysHeadImg=null,t.VicePlaysName=null,t.VicePlaysHeadImg=null,t.HomePage=null,t.BattlePage=null,t.userData={},t}return __extends(t,e),t.prototype.onClickBackButton=function(){this.WebScoketNode.getComponent(o.default).sendMessage({msg:3}),this.node.destroy()},t.prototype.start=function(){var a=this;this.HomePage=cc.find("Canvas/HomePagePanel"),this.userData=this.HomePage.getComponent(n.default).UserData,cc.loader.load({url:a.userData.headimgurl,type:"png"},function(t,e){a.headImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),this.WebScoketNode=cc.find("WebScoket"),this.WebScoketNode.getComponent(o.default).sendMessage({msg:2})},t.prototype.setBattelData=function(t){var a=this;this.Success.active=!0,t.data?(this.MainPlaysName.getComponent(cc.Label).string=this.userData.nickname,cc.loader.load({url:a.userData.headimgurl,type:"png"},function(t,e){a.MainPlaysHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}),this.VicePlaysName.getComponent(cc.Label).string=t.enemyData.nickname,cc.loader.load({url:t.enemyData.headimgurl,type:"png"},function(t,e){a.VicePlaysHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)})):(this.VicePlaysName.getComponent(cc.Label).string=this.userData.nickname,this.VicePlaysHeadImg.getComponent(cc.Sprite).spriteFrame=this.headImg.getComponent(cc.Sprite).spriteFrame,this.MainPlaysName.getComponent(cc.Label).string=t.enemyData.nickname,cc.loader.load({url:t.enemyData.headimgurl,type:"png"},function(t,e){a.MainPlaysHeadImg.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e)}));var e=cc.instantiate(this.BattlePage);e.parent=this.node.parent,e.zIndex=-1,t.data?e.getComponent(i.default).initScore(0):e.getComponent(i.default).initScore(1),setTimeout(function(){t.data&&e.getComponent(i.default).sendCallBackFor0(),e.zIndex=1,a.destroy()},1e3)},__decorate([c(cc.Node)],t.prototype,"headImg",void 0),__decorate([c(cc.Node)],t.prototype,"Success",void 0),__decorate([c(cc.Node)],t.prototype,"MainPlaysName",void 0),__decorate([c(cc.Node)],t.prototype,"MainPlaysHeadImg",void 0),__decorate([c(cc.Node)],t.prototype,"VicePlaysName",void 0),__decorate([c(cc.Node)],t.prototype,"VicePlaysHeadImg",void 0),__decorate([c(cc.Prefab)],t.prototype,"BattlePage",void 0),t=__decorate([l],t)}(cc.Component);a.default=s,cc._RF.pop()},{"../WebSocketManage":"WebSocketManage","./BattleCatrl":"BattleCatrl","./HomePageCtrl":"HomePageCtrl"}],PlayerOperationCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"c8f9bczRL9LBY0TeU61gGwq","PlayerOperationCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("./Page/BattleCatrl"),n=t("./WebSocketManage"),i=cc._decorator,r=i.ccclass,l=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BattleRegion=null,t.Buttle=null,t.player=null,t.rotationStatus=0,t.moveStatus=0,t.BattleCtrl=null,t.WebScoket=null,t.i=0,t.correct=-1,t}return __extends(t,e),t.prototype.start=function(){this.BattleCtrl=this.node.parent.parent.getComponent(o.default),this.WebScoket=cc.find("WebScoket").getComponent(n.default);var a=this;this.node.getChildByName("left").on(cc.Node.EventType.TOUCH_START,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=1}),this.node.getChildByName("left").on(cc.Node.EventType.TOUCH_END,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=0}),this.node.getChildByName("left").on(cc.Node.EventType.TOUCH_CANCEL,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=0}),this.node.getChildByName("right").on(cc.Node.EventType.TOUCH_START,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=2}),this.node.getChildByName("right").on(cc.Node.EventType.TOUCH_CANCEL,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=0}),this.node.getChildByName("right").on(cc.Node.EventType.TOUCH_END,function(t){a.getPlayer(a.BattleCtrl.playerName),a.rotationStatus=0}),this.node.getChildByName("up").on(cc.Node.EventType.TOUCH_START,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=1}),this.node.getChildByName("up").on(cc.Node.EventType.TOUCH_CANCEL,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=0}),this.node.getChildByName("up").on(cc.Node.EventType.TOUCH_END,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=0}),this.node.getChildByName("bottom").on(cc.Node.EventType.TOUCH_START,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=2}),this.node.getChildByName("bottom").on(cc.Node.EventType.TOUCH_CANCEL,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=0}),this.node.getChildByName("bottom").on(cc.Node.EventType.TOUCH_END,function(t){a.getPlayer(a.BattleCtrl.playerName),a.moveStatus=0}),this.node.getChildByName("fire").on(cc.Node.EventType.TOUCH_START,function(t){var e=0;a.getPlayer(a.BattleCtrl.playerName),a.player.parent.children.map(function(t){11<t.name.length&&e++}),e<5&&(a.i=(a.i+1)%5,a.generateBullet("tank_buttle_"+a.i))})},t.prototype.generateBullet=function(t){var e=cc.instantiate(this.Buttle);e.name=t;var a=this.player.scale,o=this.player.rotation;e.scale=a,e.rotation=o,e.zIndex=-1;var n=this.player.x,i=this.player.y,r=this.player.x,l=this.player.y+this.player.height*a/2+2,c=(l-i)*Math.sin(Math.PI*o/180)+n,s=(l-i)*Math.cos(Math.PI*o/180)+(r-n)*Math.sin(Math.PI*o/180)+i;e.setPosition(c,s),this.player.parent.addChild(e),this.WebScoket.sendMessage({msg:23,data:{buttleName:e.name,scale:a,x:c,y:s,rotation:o}})},t.prototype.generateReceiveButtle=function(t){this.getPlayer(this.BattleCtrl.playerName);var e=cc.instantiate(this.Buttle);console.log(e.name),e.name=t.data.buttleName,e.scale=t.data.scale,e.rotation=t.data.rotation,e.setPosition(t.data.x,t.data.y);var a="tank_2";console.log(this.player),"tank_2"===this.player.name&&(a="tank_1"),this.getTankName(a).parent.addChild(e)},t.prototype.getTankName=function(t){var e=this.BattleRegion.children;if(e)for(var a=0;a<e.length;a++)if(e[a].getChildByName(t))return e[a].getChildByName(t)},t.prototype.getPlayer=function(t){var e=this.BattleRegion.children;if(e){for(var a=0;a<e.length;a++)if(e[a].getChildByName(t))return void(this.player=e[a].getChildByName(t));console.log(this.player)}},t.prototype.update=function(t){if(1===this.rotationStatus&&(this.player.rotation-5<0?this.player.rotation=360-this.player.rotation-5:this.player.rotation=this.player.rotation-5,this.sendTankData()),2===this.rotationStatus&&(this.player.rotation=(this.player.rotation+5)%360,this.sendTankData()),1===this.moveStatus){var e=5;this.player.x+=e*Math.sin(Math.PI*this.player.rotation/180),this.player.y+=e*Math.cos(Math.PI*this.player.rotation/180),console.log(this.player.x,this.player.y),this.sendTankData()}if(2===this.moveStatus){e=5;this.player.x-=e*Math.sin(Math.PI*this.player.rotation/180),this.player.y-=e*Math.cos(Math.PI*this.player.rotation/180),this.sendTankData()}},t.prototype.sendTankData=function(){this.WebScoket.sendMessage({msg:22,data:{tankName:this.BattleCtrl.playerName,x:this.player.x,y:this.player.y,rotation:this.player.rotation}})},t.prototype.setOtherTankDataFor2=function(t){var e=null;"2"===t.dataMessage&&(e=this.getTankName(t.data.tankName)),e&&(e.x=t.data.x,e.y=t.data.y,e.rotation=t.data.rotation)},__decorate([l(cc.Node)],t.prototype,"BattleRegion",void 0),__decorate([l(cc.Prefab)],t.prototype,"Buttle",void 0),t=__decorate([r],t)}(cc.Component);a.default=c,cc._RF.pop()},{"./Page/BattleCatrl":"BattleCatrl","./WebSocketManage":"WebSocketManage"}],TankCtrl:[function(t,e,a){"use strict";cc._RF.push(e,"33ad7W4Sq9CJ4BpgZFyxICj","TankCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var n=t("../Page/BattleCatrl"),o=cc._decorator,i=o.ccclass,r=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){this.playerRg=this.getComponent(cc.RigidBody)},e.prototype.update=function(){},e.prototype.onCollisionEnter=function(t,e){var a=t.node.name.substring(5,11),o=0;("tank_1"===e.node.name&&(o=1),"buttle"===a)&&(this.node.destroy(),t.node.destroy(),cc.find("Canvas/BattlePagePanel").getComponent(n.default).restart(o))},e=__decorate([i],e)}(cc.Component));a.default=r,cc._RF.pop()},{"../Page/BattleCatrl":"BattleCatrl"}],WebSocketManage:[function(t,e,a){"use strict";cc._RF.push(e,"8aeccTbL45CTogTfRwPMgzA","WebSocketManage"),Object.defineProperty(a,"__esModule",{value:!0});var o=t("./Page/BattleCatrl"),n=t("./PlayerOperationCtrl"),i=t("./Page/HomePageCtrl"),r=t("./Page/MatchingCtrl"),l=cc._decorator,c=l.ccclass,s=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BattlePage=null,t.Operation=null,t.HomePage=null,t.MatchingPage=null,t}return __extends(t,e),t.prototype.start=function(){var a=this;this.ws=new WebSocket("ws://app.ei-marketing.net/tankWar/echo.do"),this.ws.onopen=function(t){console.log("服务器已打开")},this.ws.onerror=function(t){console.log("连接服务器失败")},this.ws.onclose=function(t){console.log("服务器关闭")},this.ws.onmessage=function(t){var e=JSON.parse(t.data);"-1"===e.dataMessage&&(a.HomePage=cc.find("Canvas/HomePagePanel"),a.HomePage.getComponent(i.default).getUserData(e)),"0"===e.dataMessage&&(a.HomePage=cc.find("Canvas/HomePagePanel"),a.HomePage.getComponent(i.default).enemyUserData=e.enemyData,a.MatchingPage=cc.find("Canvas/MatchingPagePanel"),a.MatchingPage.getComponent(r.default).setBattelData(e)),"1"===e.dataMessage&&(a.BattlePage=cc.find("Canvas/BattlePagePanel"),a.BattlePage.getComponent(o.default).sendCallBackFor1(e)),"2"===e.dataMessage&&(a.Operation=cc.find("Canvas/BattlePagePanel/BattleBox/operation"),a.Operation.getComponent(n.default).setOtherTankDataFor2(e)),"3"===e.dataMessage&&(a.Operation=cc.find("Canvas/BattlePagePanel/BattleBox/operation"),a.Operation.getComponent(n.default).generateReceiveButtle(e))}},t.prototype.sendMessage=function(t){var e=JSON.stringify(t);this.ws.send(e)},t=__decorate([c],t)}(cc.Component));a.default=s,cc._RF.pop()},{"./Page/BattleCatrl":"BattleCatrl","./Page/HomePageCtrl":"HomePageCtrl","./Page/MatchingCtrl":"MatchingCtrl","./PlayerOperationCtrl":"PlayerOperationCtrl"}],init:[function(t,e,a){"use strict";cc._RF.push(e,"3ff06I6ha1G4Y7NMh0WTs/7","init"),cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(),cc._RF.pop()},{}]},{},["BattleCatrl","HomePageCtrl","LobbyPageCtrl","LoginPageCtrl","MatchingCtrl","BulletCtrl","CellCtrl","TankCtrl","PlayerOperationCtrl","LinkedMap","WebSocketManage","init"]);