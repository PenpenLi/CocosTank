{"version":3,"sources":["HomePageCtrl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\Page","sourcesContent":["import WebSocketManage from '../Unit/WebSocketManage';\r\nimport { AudioSource } from '../../creator';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n    @property(cc.Prefab)\r\n    lobbyPanel: cc.Prefab = null;\r\n    @property(cc.SpriteFrame)\r\n    openSoundSprite: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    closeSoundSprite: cc.SpriteFrame = null;\r\n    @property(cc.AudioSource)\r\n    bgSound: AudioSource = null;\r\n    public IsSound: boolean = true;//是否开启音效\r\n\r\n    @property(cc.Node)\r\n    private ping: cc.Node = null;\r\n    public enemyUserData = {};\r\n    @property(cc.Node)\r\n    private WebScoketNode: cc.Node = null;\r\n\r\n    public userInfo = {\r\n        openid: '',\r\n        nickname: '',\r\n        headimgurl: ''\r\n    }\r\n    private WebSocket: WebSocketManage = null;\r\n    start() {\r\n        var _self = this;\r\n        this.WebSocket = this.WebScoketNode.getComponent(WebSocketManage);\r\n        // wx.showShareMenu();\r\n        // wx.login({\r\n        //     success: function(res) {\r\n        //         var xhr = new XMLHttpRequest();\r\n        //         xhr.onreadystatechange = function() {\r\n        //             if(xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n        //                 var response = JSON.parse(xhr.responseText);\r\n        //                 _self.userInfo.openid = response.openid;\r\n        //             }\r\n        //         }\r\n        //         xhr.open('GET', `http://172.17.0.13:8080/tankWar/acceputJSCODE.do?JSCODE=${res.code}`, true);\r\n        //         xhr.send();\r\n        //     }\r\n        // })\r\n        // wx.authorize({ scope: 'scope.userInfo' })\r\n        this.ping.zIndex = 9999;\r\n        this.getPing()\r\n    }\r\n    /**\r\n     * 点击开始\r\n     */\r\n    OnClickStartButton() {\r\n        var _self = this;\r\n        console.log(_self.userInfo,'===')\r\n        // wx.shareAppMessage({\r\n        //     title: '转发标题'\r\n        // })\r\n        // wx.getSetting({\r\n        //     success: function(res) {\r\n        //         console.log(_self.userInfo)\r\n        //         if(res.authSetting['scope.userInfo']) {\r\n        //             wx.getUserInfo({\r\n        //                 success: function(res) {\r\n        //                     res = res.userInfo;\r\n        //                     _self.userInfo.nickname = res.nickName\r\n        //                     _self.userInfo.headimgurl = res.avatarUrl\r\n        //                     console.log(_self.userInfo)\r\n        //                     var xhr = new XMLHttpRequest();\r\n        //                     xhr.onreadystatechange = function() {\r\n        //                     }\r\n        //                     xhr.open('GET', `http://172.17.0.13:8080/tankWar/wechatUserinfo.do?openid=${_self.userInfo.openid}&nickname=${_self.userInfo.nickname}&headimgurl=${_self.userInfo.headimgurl}`, true);\r\n        //                     xhr.send();\r\n        //                 }\r\n        //             })\r\n        //         }\r\n        //     },\r\n        //     fail: function(res){\r\n        //         console.log(res)\r\n        //     }\r\n        // })\r\n        _self.WebSocket.sendMessage({msg: 1})\r\n    }\r\n    /**\r\n     * 点击声音按钮\r\n     */\r\n    OnClickSoundButton(event) {\r\n        this.IsSound = !this.IsSound;\r\n        var buttonSprite: cc.Sprite = event.target.getComponent(cc.Sprite);\r\n        this.IsSound ? (buttonSprite.spriteFrame = this.openSoundSprite, this.bgSound.resume()) : (buttonSprite.spriteFrame = this.closeSoundSprite, this.bgSound.pause())\r\n    }\r\n    getPing() {\r\n        var self = this;\r\n        setTimeout(() => {\r\n            self.getPing();\r\n        }, 1000)\r\n        var url = 'http://app.ei-marketing.net/tankWar/ping.do'\r\n        // var url = 'http://172.17.0.13:8080/tankWar/ping.do'\r\n        var xmlHttp;\r\n        var start = new Date().getTime();\r\n        xmlHttp = new XMLHttpRequest();\r\n        xmlHttp.onreadystatechange = state_Change;\r\n        xmlHttp.open('GET', url, true);\r\n        xmlHttp.send(null);\r\n        function state_Change() {\r\n            if (xmlHttp.readyState === 4) {\r\n                if (xmlHttp.status === 200) {\r\n                    var end = new Date().getTime();\r\n                    self.ping.getComponent(cc.Label).string = (end - start) + 'ms'\r\n                }\r\n            }\r\n        }\r\n    }\r\n    public getUserData(response) {\r\n        this.userInfo = response.data;\r\n        var lobbyPanelPage = cc.instantiate(this.lobbyPanel);\r\n        lobbyPanelPage.parent = this.node.parent;\r\n        this.enabled = false;\r\n    }\r\n}\r\n"]}